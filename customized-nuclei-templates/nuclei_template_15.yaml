id: xss-deprecated-header

info:
  name: XSS-Protection Header - Cross-Site Scripting
  author: devsecops
  severity: medium
  description: Setting the XSS-Protection header is deprecated. Setting the header
    to anything other than `0` can actually introduce an XSS vulnerability.
  reference:
  - https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-XSS-Protection
  - https://owasp.org/www-project-secure-headers/#x-xss-protection
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:N/E:H/RL:O/RC:C
    cvss-score: 4.0
  metadata:
    max-request: 1
  tags: xss,misconfig,generic

http:
- method: POST
  path:
  - '{{BaseURL}}/private-bancolombia/testing/v1/operations/risk-compliance/models/fraud-models/CustomerContactManagement'
  matchers-condition: and
  matchers:
  - type: regex
    part: header
    regex:
    - '(?i)x-xss-protection: 0'
    negative: true

  - type: regex
    part: header
    regex:
    - '(?i)x-xss-protection: 1+'

  extractors:
  - type: kval
    part: header
    kval:
    - x_xss_protection

# digest: 4b0a00483046022100bf9a6e90e4d3004caff9982d22093726978d7b063269b438ab75ea2bcba15a19022100ce53a1ef6ffb2b220c86574ebc654c0d0b2ca16c42cc940cef32e369f5f5ef07:922c64590222798bb761d5b6d8e72950
  headers:
    accept: application/vnd.bancolombia.v4+json
    client-id: 1c397a732e5763619a45d3ffb117f01e
    client-secret: 6b8fb3748f756daffb6d5e421d311bbe
    content-type: application/vnd.bancolombia.v4+json
    messageid: c4e6bd04-5149-11e7-b114-b2f933d5fe66
