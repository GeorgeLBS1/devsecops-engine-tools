---
metadata:
  name: "IAM has roles with tags"
  id: "CKV2_AWS_118"
  category: "GENERAL_SECURITY"
definition:
  and:
     - cond_type: "filter"
       attribute: "resource_type"
       value:
       - "AWS::IAM::User"
       operator: "within"
     - cond_type: "attribute"
       resource_types:
       - "AWS::IAM::User"
       attribute: "Tags"
       operator: "exists"
     - cond_type: "attribute"
       resource_types:
       - "AWS::IAM::User"
       attribute: "Tags.*.Key"
       operator: "exists"
     - cond_type: "attribute"
       resource_types:
       - "AWS::IAM::User"
       attribute: "Tags.*.Value"
       operator: "exists"
     - cond_type: "attribute"
       resource_types:
       - "AWS::IAM::User"
       attribute: "Tags.*.Key"
       operator: "equals"
       value: "bancolombia:distribution-list"   
     - cond_type: "attribute"
       resource_types:
       - "AWS::IAM::User"
       attribute: "Tags.*.Key"
       operator: "equals"
       value: "bancolombia:owner"
     - cond_type: "attribute"
       resource_types:
       - "AWS::IAM::User"
       attribute: "Tags.*.Key"
       operator: "equals"
       value: "bancolombia:user-history"