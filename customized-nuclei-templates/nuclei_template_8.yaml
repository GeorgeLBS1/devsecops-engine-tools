id: content-security-policy-header

info:
  name: Content Security Policy
  author: devsecops
  severity: low
  description: |
    The application has unnsafe configurations regarding the Content-Security-Policy header. This may be because:

    - Header is missing from server responses.
    - The header has not defined mandatory security policies.
    - Defined security policies contain insecure values.
  metadata:
    max-request: 1
  tags: misconfig,headers,generic
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:N/E:P/RL:O/RC:C
    cvss-score: 3.8
http:
- method: POST
  path:
  - '{{BaseURL}}/private-bancolombia/testing/v1/operations/risk-compliance/models/fraud-models/CustomerContactManagement'
  host-redirects: true
  max-redirects: 3

  matchers-condition: or
  matchers:
  - type: dsl
    name: content-security-policy
    dsl:
    - "!regex('(?i)content-security-policy', header)"
    - status_code != 301 && status_code != 302
    condition: and
  headers:
    accept: application/vnd.bancolombia.v4+json
    client-id: 1c397a732e5763619a45d3ffb117f01e
    client-secret: 6b8fb3748f756daffb6d5e421d311bbe
    content-type: application/vnd.bancolombia.v4+json
    messageid: c4e6bd04-5149-11e7-b114-b2f933d5fe66
