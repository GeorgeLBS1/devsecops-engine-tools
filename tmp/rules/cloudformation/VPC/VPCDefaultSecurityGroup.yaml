metadata:
  name: "Ensure VPC don't uses the default Security Group"
  id: "CKV2_AWS_114"
  category: "GENERAL_SECURITY"
definition:
  and:
    - cond_type: "filter"
      attribute: "resource_type"
      value:
        - AWS::EC2::VPC
      operator: within
    - cond_type: "connection"
      resource_types:
        - AWS::EC2::VPC
      connected_resource_types:
        - AWS::EC2::SecurityGroup
      operator: exists
    - or:
      - cond_type: "attribute"
        resource_types:
          - "AWS::EC2::SecurityGroup"
        attribute: "SecurityGroupIngress"
        operator: "exists"
      - cond_type: "connection"
        resource_types:
          - AWS::EC2::SecurityGroup
        connected_resource_types:
          - AWS::EC2::SecurityGroupIngress
        operator: exists