metadata:
  name: "Ensure define the DeleteOnTermination property is false."
  id: "CKV2_AWS_133"
  category: "GENERAL_SECURITY"
definition:
  or:
    - cond_type: "attribute"
      resource_types:
        - "AWS::EC2::LaunchTemplate"
      attribute: "LaunchTemplateData.BlockDeviceMappings.*.Ebs"
      operator: "not_exists"
    - and:
      - cond_type: "attribute"
        resource_types:
          - "AWS::EC2::LaunchTemplate"
        attribute: "LaunchTemplateData.BlockDeviceMappings.*.Ebs"
        operator: "exists"
      - cond_type: "attribute"
        resource_types:
          - "AWS::EC2::LaunchTemplate"
        attribute: "LaunchTemplateData.BlockDeviceMappings.*.Ebs.DeleteOnTermination"
        operator: "exists"
      - cond_type: "attribute"
        resource_types:
          - "AWS::EC2::LaunchTemplate"
        attribute: "LaunchTemplateData.BlockDeviceMappings.*.Ebs.DeleteOnTermination"
        operator: "equals"
        value: false