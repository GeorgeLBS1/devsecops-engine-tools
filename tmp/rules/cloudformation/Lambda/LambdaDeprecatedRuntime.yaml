metadata:
  name: "Check that Lambda function don't use runtime deprecated"
  id: "CKV2_AWS_112"
  category: "GENERAL_SECURITY"
definition:
  or:
    - cond_type: "attribute"
      resource_types:
        - "AWS::Lambda::Function"
      attribute: "PackageType"
      operator: "contains"
      value: Image
    - and:
        - cond_type: "attribute"
          resource_types:
            - "AWS::Lambda::Function"
          attribute: "Runtime"
          operator: "exists"
        - or:
            - cond_type: "attribute"
              resource_types:
                - "AWS::Lambda::Function"
              attribute: "Runtime"
              operator: "regex_match"
              value: "python3.[7-9]"
            - cond_type: "attribute"
              resource_types:
                - "AWS::Lambda::Function"
              attribute: "Runtime"
              operator: "regex_match"
              value: "nodejs1[3-9].x"